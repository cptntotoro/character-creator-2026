<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ü–µ—Ä—Å–æ–Ω–∞–∂–∞ 2026 | RPG –¥–ª—è –º–∏–ª–ª–µ–Ω–∏–∞–ª–æ–≤</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ */
    :root {
      --primary: #8a2be2;
      --secondary: #9370db;
      --accent: #ff6b6b;
      --dark: #2d1b69;
      --light: #f8f7ff;
      --gray: #e0e0e0;
      --dark-gray: #555;
      --success: #4CAF50;
      --warning: #ff9800;
      --card-bg: rgba(255, 255, 255, 0.95);
      --border-radius: 16px;
      --shadow: 0 10px 30px rgba(138, 43, 226, 0.15);
      --pixel-font: 'Courier New', monospace;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
      color: #333;
      line-height: 1.6;
      min-height: 100vh;
      padding: 20px;
      background-attachment: fixed;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    /* –®–∞–ø–∫–∞ */
    header {
      text-align: center;
      margin-bottom: 30px;
      padding: 20px;
      border-radius: var(--border-radius);
      background: var(--card-bg);
      box-shadow: var(--shadow);
      position: relative;
      overflow: hidden;
    }

    header::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 5px;
      background: linear-gradient(to right, var(--primary), var(--accent), var(--primary));
    }

    h1 {
      color: var(--dark);
      font-size: 2.8rem;
      margin-bottom: 10px;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
      font-family: var(--pixel-font);
    }

    .subtitle {
      color: var(--dark-gray);
      font-size: 1.2rem;
      margin-bottom: 20px;
    }

    /* –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã */
    .section {
      background: var(--card-bg);
      border-radius: var(--border-radius);
      padding: 25px;
      margin-bottom: 25px;
      box-shadow: var(--shadow);
      border: 2px solid var(--gray);
    }

    .section-title {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
      color: var(--primary);
      font-size: 1.5rem;
      font-weight: 700;
    }

    .section-title i {
      margin-right: 10px;
      font-size: 1.8rem;
    }

    /* –í–≤–æ–¥ –∏–º–µ–Ω–∏ */
    .name-input {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .name-input label {
      font-weight: 600;
      color: var(--dark);
    }

    #character-name {
      padding: 15px;
      border: 3px solid var(--secondary);
      border-radius: 12px;
      font-size: 1.2rem;
      outline: none;
      transition: all 0.3s;
      font-family: var(--pixel-font);
    }

    #character-name:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(138, 43, 226, 0.2);
    }

    /* –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ */
    .stats-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
    }

    .stat {
      display: flex;
      flex-direction: column;
      background: linear-gradient(to right, #f9f7ff, #ffffff);
      padding: 20px;
      border-radius: 12px;
      border-left: 5px solid var(--primary);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
      transition: transform 0.3s;
    }

    .stat:hover {
      transform: translateY(-5px);
    }

    .stat-header {
      display: flex;
      align-items: center;
      margin-bottom: 15px;
    }

    .stat-icon {
      font-size: 2.5rem;
      margin-right: 15px;
      width: 60px;
      text-align: center;
    }

    .stat-info h3 {
      font-size: 1.3rem;
      color: var(--dark);
      margin-bottom: 5px;
    }

    .stat-info p {
      color: var(--dark-gray);
      font-size: 0.95rem;
    }

    .stat-controls {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-top: 10px;
    }

    .stat-value {
      font-size: 2.5rem;
      font-weight: 700;
      color: var(--primary);
      font-family: var(--pixel-font);
      min-width: 60px;
      text-align: center;
    }

    .stat-buttons {
      display: flex;
      gap: 10px;
    }

    .stat-btn {
      width: 45px;
      height: 45px;
      border: none;
      border-radius: 50%;
      background: var(--primary);
      color: white;
      font-size: 1.5rem;
      font-weight: bold;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .stat-btn:hover {
      background: var(--secondary);
      transform: scale(1.1);
    }

    .stat-btn:active {
      transform: scale(0.95);
    }

    .stat-btn:disabled {
      background: var(--gray);
      color: var(--dark-gray);
      cursor: not-allowed;
      transform: none;
    }

    /* –û—á–∫–∏ */
    .points-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: linear-gradient(to right, #8a2be2, #9370db);
      color: white;
      padding: 20px;
      border-radius: var(--border-radius);
      margin-bottom: 25px;
      box-shadow: var(--shadow);
    }

    .points-left {
      font-size: 2.5rem;
      font-weight: 700;
      font-family: var(--pixel-font);
      color: white;
    }

    .points-label {
      font-size: 1.2rem;
    }

    .points-warning {
      font-size: 1rem;
      opacity: 0.9;
    }

    /* –ü–µ—Ä–∫–∏ */
    .perks-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 20px;
    }

    .perk {
      background: linear-gradient(to bottom right, #ffffff, #f9f7ff);
      border: 2px solid var(--gray);
      border-radius: 12px;
      padding: 20px;
      cursor: pointer;
      transition: all 0.3s;
      position: relative;
      overflow: hidden;
    }

    .perk::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 5px;
      height: 100%;
      background: var(--primary);
      opacity: 0;
      transition: opacity 0.3s;
    }

    .perk:hover {
      border-color: var(--secondary);
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
    }

    .perk:hover::before {
      opacity: 1;
    }

    .perk.selected {
      border-color: var(--primary);
      background: linear-gradient(to bottom right, #f0e6ff, #ffffff);
    }

    .perk.selected::before {
      opacity: 1;
    }

    .perk-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 15px;
    }

    .perk-title {
      font-size: 1.3rem;
      color: var(--dark);
      font-weight: 700;
    }

    .perk-cost {
      background: var(--accent);
      color: white;
      padding: 5px 12px;
      border-radius: 20px;
      font-weight: 700;
      font-size: 0.9rem;
    }

    .perk-desc {
      color: var(--dark-gray);
      margin-bottom: 15px;
      font-size: 1rem;
    }

    .perk-tag {
      display: inline-block;
      background: var(--secondary);
      color: white;
      padding: 3px 10px;
      border-radius: 12px;
      font-size: 0.8rem;
      margin-top: 10px;
    }

    .perk-checkbox {
      position: absolute;
      opacity: 0;
    }

    .perk-checkmark {
      position: absolute;
      top: 15px;
      right: 15px;
      width: 25px;
      height: 25px;
      border-radius: 50%;
      border: 2px solid var(--gray);
      background: white;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .perk.selected .perk-checkmark {
      background: var(--primary);
      border-color: var(--primary);
    }

    .perk.selected .perk-checkmark::after {
      content: "‚úì";
      color: white;
      font-weight: bold;
    }

    /* –ö–Ω–æ–ø–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ */
    .generate-btn-container {
      text-align: center;
      margin: 30px 0;
    }

    #generate-btn {
      background: linear-gradient(to right, var(--primary), var(--secondary));
      color: white;
      border: none;
      padding: 20px 50px;
      font-size: 1.5rem;
      font-weight: 700;
      border-radius: 50px;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: 0 10px 20px rgba(138, 43, 226, 0.3);
      font-family: var(--pixel-font);
      letter-spacing: 1px;
    }

    #generate-btn:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 25px rgba(138, 43, 226, 0.4);
    }

    #generate-btn:active {
      transform: translateY(0);
    }

    #generate-btn:disabled {
      background: var(--gray);
      color: var(--dark-gray);
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    /* –ö–∞—Ä—Ç–æ—á–∫–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ */
    .character-card {
      display: none;
      background: linear-gradient(135deg, #ffffff 0%, #f9f7ff 100%);
      border-radius: var(--border-radius);
      padding: 30px;
      box-shadow: var(--shadow);
      border: 3px solid var(--primary);
      margin-top: 30px;
      position: relative;
      overflow: hidden;
    }

    .character-card::before {
      content: "";
      position: absolute;
      top: 0;
      right: 0;
      width: 150px;
      height: 150px;
      background: linear-gradient(45deg, rgba(138, 43, 226, 0.1), rgba(255, 107, 107, 0.1));
      border-radius: 0 0 0 100%;
    }

    .card-header {
      text-align: center;
      margin-bottom: 30px;
      border-bottom: 2px dashed var(--gray);
      padding-bottom: 20px;
    }

    .card-title {
      font-size: 2.2rem;
      color: var(--dark);
      margin-bottom: 10px;
      font-family: var(--pixel-font);
    }

    .card-subtitle {
      color: var(--accent);
      font-size: 1.2rem;
      font-weight: 700;
    }

    /* –°–µ—Ç–∫–∞ 2x2 –¥–ª—è –∫–∞—Ä—Ç–æ—á–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ */
    .card-content {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 25px;
    }

    .card-section {
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
      display: flex;
      flex-direction: column;
    }

    .card-section h3 {
      color: var(--primary);
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      font-size: 1.4rem;
      flex-shrink: 0;
    }

    .card-section h3 i {
      margin-right: 10px;
    }

    /* –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ */
    .stat-container {
      flex: 1;
      overflow-y: auto;
      padding-right: 5px;
    }

    .stat-bar {
      display: flex;
      align-items: center;
      margin-bottom: 12px;
      justify-content: space-between;
    }

    .stat-name {
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 600;
      font-size: 1.1rem;
    }

    .stat-icon {
      font-size: 1.4rem;
    }

    .stat-value {
      font-size: 1.8rem;
      font-weight: 700;
      color: var(--primary);
      font-family: var(--pixel-font);
      min-width: 60px;
      text-align: center;
    }

    /* –ü–µ—Ä–∫–∏ */
    .perk-list-container {
      flex: 1;
      overflow-y: auto;
      padding-right: 5px;
    }

    .perk-list {
      list-style-type: none;
      flex: 1;
    }

    .perk-list li {
      padding: 10px 0;
      border-bottom: 1px dashed var(--gray);
      display: flex;
      align-items: flex-start;
    }

    .perk-list li:last-child {
      border-bottom: none;
    }

    .perk-list i {
      color: var(--success);
      margin-right: 10px;
      margin-top: 2px;
      flex-shrink: 0;
    }

    .perk-list span {
      line-height: 1.4;
    }

    /* –ë–ª–æ–∫–∏ –±–∞—Ñ—Ñ–∞ –∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è */
    .buff-box, .prediction-box {
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    .buff-box-content, .prediction-box-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .buff-box {
      background: linear-gradient(135deg, #e6f7ff, #f0f8ff);
      padding: 20px;
      border-radius: 12px;
      border-left: 5px solid var(--accent);
      height: 100%;
    }

    .buff-title {
      color: var(--accent);
      font-size: 1.4rem;
      margin-bottom: 10px;
    }

    .buff-box p, .prediction-box p {
      line-height: 1.5;
    }

    .prediction-box {
      background: linear-gradient(135deg, #fff8e6, #fffaf0);
      padding: 20px;
      border-radius: 12px;
      border-left: 5px solid var(--warning);
      height: 100%;
    }

    .prediction-title {
      color: var(--warning);
      font-size: 1.4rem;
      margin-bottom: 10px;
    }

    .share-buttons {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-top: 30px;
    }

    .share-btn {
      padding: 12px 25px;
      border: none;
      border-radius: 30px;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      transition: all 0.3s;
    }

    .share-btn.save {
      background: linear-gradient(to right, var(--primary), var(--secondary));
      color: white;
    }

    .share-btn.reset {
      background: linear-gradient(to right, var(--accent), #ff8e8e);
      color: white;
    }

    .share-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }

    /* –§—É—Ç–µ—Ä */
    footer {
      text-align: center;
      color: white;
      margin-top: 40px;
      padding: 20px;
      opacity: 0.8;
      font-size: 0.9rem;
    }

    /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
    @media (max-width: 768px) {
      h1 {
        font-size: 2rem;
      }

      .stats-container {
        grid-template-columns: 1fr;
      }

      .perks-container {
        grid-template-columns: 1fr;
      }

      .points-container {
        flex-direction: column;
        gap: 15px;
        text-align: center;
      }

      .stat {
        padding: 15px;
      }

      .stat-icon {
        font-size: 2rem;
        width: 50px;
      }

      .stat-info h3 {
        font-size: 1.2rem;
      }

      .card-content {
        grid-template-columns: 1fr;
        gap: 20px;
      }

      .card-section {
        min-height: auto;
      }

      .share-buttons {
        flex-direction: column;
      }
    }

    @media (max-width: 480px) {
      body {
        padding: 10px;
      }

      .section {
        padding: 20px 15px;
      }

      .stat-controls {
        flex-direction: column;
        align-items: flex-start;
        gap: 15px;
      }

      .stat-buttons {
        align-self: center;
      }
    }
  </style>
</head>
<body>
<div class="container">
  <header>
    <h1><i class="fas fa-dice-d20"></i> –ì–ï–ù–ï–†–ê–¢–û–† –ü–ï–†–°–û–ù–ê–ñ–ê 2026</h1>
    <p class="subtitle">–°–æ–∑–¥–∞–π —Å–≤–æ—é –ª—É—á—à—É—é –≤–µ—Ä—Å–∏—é –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –≥–æ–¥ –≤ —Å—Ç–∏–ª–µ RPG –¥–ª—è –º–∏–ª–ª–µ–Ω–∏–∞–ª–æ–≤</p>
  </header>

  <div class="points-container">
    <div>
      <div class="points-label">–û—á–∫–æ–≤ –¥–æ—Å—Ç—É–ø–Ω–æ:</div>
      <div class="points-left" id="points-left">15</div>
    </div>
    <div class="points-warning">
      <i class="fas fa-info-circle"></i> –†–∞—Å–ø—Ä–µ–¥–µ–ª–∏ 15 –æ—á–∫–æ–≤ –º–µ–∂–¥—É —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏
    </div>
  </div>

  <div class="section">
    <div class="section-title">
      <i class="fas fa-user"></i>
      <span>1. –¢–í–û–Å –ò–ú–Ø –í 2026</span>
    </div>
    <div class="name-input">
      <label for="character-name">–í–≤–µ–¥–∏ –∏–º—è –∏–ª–∏ –ø—Å–µ–≤–¥–æ–Ω–∏–º –¥–ª—è —Å–≤–æ–µ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞:</label>
      <input type="text" id="character-name" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –õ–µ–Ω–∞ 3.0, –ú–∞–∫—Å –ë–µ–∑—Ç–æ–∫—Å–∏–∫ –∏–ª–∏ –ê–Ω–æ–Ω–∏–º–Ω—ã–π –û–ø—Ç–∏–º–∏—Å—Ç"
             maxlength="30">
    </div>
  </div>

  <div class="section">
    <div class="section-title">
      <i class="fas fa-chart-line"></i>
      <span>2. –ü–†–û–ö–ê–ß–ê–ô –•–ê–†–ê–ö–¢–ï–†–ò–°–¢–ò–ö–ò</span>
    </div>
    <div class="stats-container" id="stats-container">
      <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
    </div>
  </div>

  <div class="section">
    <div class="section-title">
      <i class="fas fa-star"></i>
      <span>3. –í–´–ë–ï–†–ò –ü–ï–†–ö–ò –ù–ê –ì–û–î</span>
    </div>
    <div class="perks-container" id="perks-container">
      <!-- –ü–µ—Ä–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
    </div>
  </div>

  <div class="generate-btn-container">
    <button id="generate-btn" disabled>
      <i class="fas fa-magic"></i> –°–û–ó–î–ê–¢–¨ –ü–ï–†–°–û–ù–ê–ñ–ê 2026
    </button>
  </div>

  <div class="character-card" id="character-card">
    <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞ —á–µ—Ä–µ–∑ JS -->
  </div>

  <footer>
    <p>–°–¥–µ–ª–∞–Ω–æ —Å ‚ù§Ô∏è –¥–ª—è –ê–ª–∏—Å—ã –∏ –ú–∏—à–∏</p>
  </footer>
</div>

<script>
  // –î–∞–Ω–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
  const statsData = [
    {
      id: 'strength',
      icon: 'üí™',
      name: '–°–∏–ª–∞ –í—ã–±–æ—Ä–∞',
      description: '–°–∫–∞–∑–∞—Ç—å "–Ω–µ—Ç" —É—Ç—Ä–µ–Ω–Ω–µ–º—É –±—É–¥–∏–ª—å–Ω–∏–∫—É –∏ "–¥–∞" –≤–µ—á–µ—Ä–Ω–∏–º –∂–µ–ª–∞–Ω–∏—è–º'
    },
    {
      id: 'dexterity',
      icon: 'üèÉ',
      name: '–õ–æ–≤–∫–æ—Å—Ç—å –£–∫–ª–æ–Ω–µ–Ω–∏—è',
      description: '–ü—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞—Ç—å –º–∏–º–æ —Ç–æ–∫—Å–∏—á–Ω—ã—Ö —á–∞—Ç–æ–≤ –∏ –Ω–µ–Ω—É–∂–Ω—ã—Ö —Å–ø–æ—Ä–æ–≤'
    },
    {
      id: 'intelligence',
      icon: 'üß†',
      name: '–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç –ü–∞–º—è—Ç–∏',
      description: '–ü–æ–º–Ω–∏—Ç—å –≥–¥–µ –∫–ª—é—á–∏, –ø–∞—Ä–æ–ª—å –æ—Ç Wi-Fi –∏ –∑–∞—á–µ–º –ø—Ä–∏—à–µ–ª –Ω–∞ –∫—É—Ö–Ω—é'
    },
    {
      id: 'wisdom',
      icon: 'üîÆ',
      name: '–ú—É–¥—Ä–æ—Å—Ç—å –í—ã–∫–ª—é—á–µ–Ω–∏—è',
      description: '–ß—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å, –∫–æ–≥–¥–∞ —Ç–µ–ª–µ—Ñ–æ–Ω—É –ø–æ—Ä–∞ –≤ –∞–≤–∏–∞—Ä–µ–∂–∏–º, –∞ —Ç–µ–±–µ - –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å'
    },
    {
      id: 'charisma',
      icon: 'üíù',
      name: '–•–∞—Ä–∏–∑–º–∞ –ü—Ä–∏–∑—ã–≤–∞',
      description: '–ß—Ç–æ–±—ã –¥—Ä—É–∑—å—è —Å–∞–º–∏ –ø–∏—Å–∞–ª–∏ "–≥–æ—É", –∞ –ø–∏—Ü—Ü–∞ –≤—Å–µ–≥–¥–∞ –±—ã–ª–∞ –≥–æ—Ä—è—á–µ–π'
    },
    {
      id: 'constitution',
      icon: 'üõ°Ô∏è',
      name: '–í—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å –î–Ω—è',
      description: '–•–≤–∞—Ç–∞—Ç—å —ç–Ω–µ—Ä–≥–∏–∏ –Ω–∞ work, workout –∏ –Ω–µ —Å–≥–æ—Ä–µ—Ç—å –¥–æ –≤–µ—á–µ—Ä–Ω–µ–≥–æ watch'
    }
  ];

  // –î–∞–Ω–Ω—ã–µ –ø–µ—Ä–∫–æ–≤
  const perksData = [
    {
      id: 'perk1',
      name: '–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —É–¥–∞—Ä –ø–æ –æ–ø–æ–∑–¥–∞–Ω–∏—è–º',
      description: '+30% —à–∞–Ω—Å –≤—ã–π—Ç–∏ –∏–∑ –¥–æ–º–∞ –≤–æ–≤—Ä–µ–º—è. –†–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –≤ –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫.',
      cost: 0,
      tag: '–ë–∞–∑–æ–≤—ã–π'
    },
    {
      id: 'perk2',
      name: '–ò–º–º—É–Ω–∏—Ç–µ—Ç –∫ —Å–æ–≤–µ—Ç–∞–º –≤ —Å–æ—Ü—Å–µ—Ç—è—Ö',
      description: '–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –∫–æ–º–º–µ–Ω—Ç—ã –æ—Ç —Ç—ë—Ç–∏ –õ—é–¥—ã –∏ "—ç–∫—Å–ø–µ—Ä—Ç–æ–≤" –∏–∑ TikTok.',
      cost: 0,
      tag: '–ë–∞–∑–æ–≤—ã–π'
    },
    {
      id: 'perk3',
      name: '–ü–∞—Å—Å–∏–≤–Ω–æ–µ —É–º–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–∏—Ç—å –∑–∞–≤—Ç—Ä–∞–∫',
      description: '–•–æ—Ç—è –±—ã —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é —è–π—Ü–∞ –Ω–µ –ø—Ä–∏–ª–∏–ø–∞—é—Ç –∫ —Å–∫–æ–≤–æ—Ä–æ–¥–∫–µ. –≠—Ç–æ –º–∞–≥–∏—è!',
      cost: 0,
      tag: '–ë–∞–∑–æ–≤—ã–π'
    },
    {
      id: 'perk4',
      name: '–ê—É—Ä–∞ "–ú–Ω–µ –Ω–µ –¥–æ –ø—Ä–æ–±–ª–µ–º"',
      description: '–ú–µ–ª–∫–∏–µ –Ω–µ—É–¥–∞—á–∏ –æ–±—Ö–æ–¥—è—Ç –≤–∞—Å —Å—Ç–æ—Ä–æ–Ω–æ–π, –∫–∞–∫ –ª—É–∂–∏ –≤ –Ω–æ–≤—ã—Ö –∫–µ–¥–∞—Ö.',
      cost: 1,
      tag: '–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π'
    },
    {
      id: 'perk5',
      name: '–¢–∞–π–º-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç –¥–ª—è –ª–µ–Ω–∏–≤—ã—Ö',
      description: '–î–µ–ª–∞ –¥–µ–ª–∞—é—Ç—Å—è —Å–∞–º–∏, –∫–æ–≥–¥–∞ –≤—ã —Å–º–æ—Ç—Ä–∏—Ç–µ —Å–µ—Ä–∏–∞–ª. –ò–ª–ª—é–∑–∏—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏!',
      cost: 1,
      tag: '–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π'
    },
    {
      id: 'perk6',
      name: '–ü–æ–≤—ã—à–µ–Ω–Ω–∞—è –∫–∞–ø–ª—è —É–¥–∞—á–∏ –≤ –∫–æ—Ñ–µ',
      description: '–£—Ç—Ä–æ–º –ø–æ–ø–∞–¥–∞–µ—Ç—Å—è –∏–¥–µ–∞–ª—å–Ω—ã–π –Ω–∞–ø–∏—Ç–æ–∫, –¥–Ω—ë–º ‚Äî –∏–¥–µ–∞–ª—å–Ω–∞—è –ø–∞—Ä–∫–æ–≤–∫–∞.',
      cost: 1,
      tag: '–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π'
    },
    {
      id: 'perk7',
      name: '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –Ω–∞–≤—ã–∫ "–í—Å—Ç—Ä–µ—Ç–∏–ª –º–µ—á—Ç—É –≤ –ª–∏—Ñ—Ç–µ"',
      description: '–†–∞–∑ –≤ –≥–æ–¥ —Å–ª—É—á–∞–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω–æ—Å—Ç—å, –∫–æ—Ç–æ—Ä–∞—è –º–µ–Ω—è–µ—Ç –≤—Å—ë –∫ –ª—É—á—à–µ–º—É.',
      cost: 2,
      tag: '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π',
      unique: true
    },
    {
      id: 'perk8',
      name: '–£–ª—å—Ç–∏–º–∞—Ç–∏–≤–Ω—ã–π —â–∏—Ç –æ—Ç —ç–Ω–µ—Ä–≥–æ–≤–∞–º–ø–∏—Ä–æ–≤',
      description: '–¢–æ–∫—Å–∏—á–Ω—ã–µ –ª—é–¥–∏ –∑–∞–±—ã–≤–∞—é—Ç –≤–∞—à –Ω–æ–º–µ—Ä. –ö–æ–ª–ª–µ–≥–∏-–Ω—ã—Ç–∏–∫–∏ –∏—â—É—Ç –¥—Ä—É–≥—É—é –∂–µ—Ä—Ç–≤—É.',
      cost: 2,
      tag: '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π',
      unique: true
    }
  ];

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
  let pointsLeft = 15;
  let stats = {};
  let selectedPerks = [];

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã
  document.addEventListener('DOMContentLoaded', function () {
    initStats();
    initPerks();
    updateUI();

    // –°–ª—É—à–∞—Ç–µ–ª—å –¥–ª—è –∏–º–µ–Ω–∏
    document.getElementById('character-name').addEventListener('input', updateGenerateButton);
  });

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
  function initStats() {
    const container = document.getElementById('stats-container');
    container.innerHTML = '';

    statsData.forEach(stat => {
      stats[stat.id] = 1; // –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ

      const statElement = document.createElement('div');
      statElement.className = 'stat';
      statElement.innerHTML = `
                    <div class="stat-header">
                        <div class="stat-icon">${stat.icon}</div>
                        <div class="stat-info">
                            <h3>${stat.name}</h3>
                            <p>${stat.description}</p>
                        </div>
                    </div>
                    <div class="stat-controls">
                        <div class="stat-value" id="value-${stat.id}">1</div>
                        <div class="stat-buttons">
                            <button class="stat-btn" onclick="decreaseStat('${stat.id}')" id="decrease-${stat.id}" disabled>-</button>
                            <button class="stat-btn" onclick="increaseStat('${stat.id}')" id="increase-${stat.id}">+</button>
                        </div>
                    </div>
                `;

      container.appendChild(statElement);
    });
  }

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–∫–æ–≤
  function initPerks() {
    const container = document.getElementById('perks-container');
    container.innerHTML = '';

    perksData.forEach(perk => {
      const perkElement = document.createElement('div');
      perkElement.className = 'perk';
      perkElement.id = `perk-${perk.id}`;
      perkElement.innerHTML = `
            <input type="checkbox" class="perk-checkbox" id="checkbox-${perk.id}">
            <div class="perk-checkmark"></div>
            <div class="perk-header">
                <div class="perk-title">${perk.name}</div>
            </div>
            <div class="perk-desc">${perk.description}</div>
        `;

      perkElement.addEventListener('click', function () {
        togglePerk(perk.id, perk.cost, perk.unique);
      });

      container.appendChild(perkElement);
    });
  }

  // –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
  function increaseStat(statId) {
    if (pointsLeft > 0 && stats[statId] < 5) {
      stats[statId]++;
      pointsLeft--;
      updateUI();
    }
  }

  // –£–º–µ–Ω—å—à–µ–Ω–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
  function decreaseStat(statId) {
    if (stats[statId] > 1) {
      stats[statId]--;
      pointsLeft++;
      updateUI();
    }
  }

  // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ø–µ—Ä–∫–∞
  function togglePerk(perkId, cost, isUnique) {
    const index = selectedPerks.indexOf(perkId);
    const perkElement = document.getElementById(`perk-${perkId}`);

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –ø–µ—Ä–∫–∞
    if (isUnique && index === -1) {
      // –£–±–∏—Ä–∞–µ–º –¥—Ä—É–≥–∏–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–µ—Ä–∫–∏
      perksData.forEach(p => {
        if (p.unique && p.id !== perkId && selectedPerks.includes(p.id)) {
          const otherIndex = selectedPerks.indexOf(p.id);
          selectedPerks.splice(otherIndex, 1);
          document.getElementById(`perk-${p.id}`).classList.remove('selected');
        }
      });
    }

    if (index === -1) {
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –º–æ–∂–Ω–æ –ª–∏ –≤—ã–±—Ä–∞—Ç—å –µ—â–µ –ø–µ—Ä–∫–∏
      if (selectedPerks.length >= 3) {
        alert('–ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ 3 –ø–µ—Ä–∫–∞!');
        return;
      }

      // –î–æ–±–∞–≤–ª—è–µ–º –ø–µ—Ä–∫
      selectedPerks.push(perkId);
      perkElement.classList.add('selected');
    } else {
      // –£–±–∏—Ä–∞–µ–º –ø–µ—Ä–∫
      selectedPerks.splice(index, 1);
      perkElement.classList.remove('selected');
    }

    updateGenerateButton();
  }

  // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
  function updateUI() {
    // –û–±–Ω–æ–≤–ª—è–µ–º –æ—á–∫–∏
    document.getElementById('points-left').textContent = pointsLeft;

    // –û–±–Ω–æ–≤–ª—è–µ–º –∑–Ω–∞—á–µ–Ω–∏—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
    statsData.forEach(stat => {
      const valueElement = document.getElementById(`value-${stat.id}`);
      const decreaseBtn = document.getElementById(`decrease-${stat.id}`);
      const increaseBtn = document.getElementById(`increase-${stat.id}`);

      valueElement.textContent = stats[stat.id];

      // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–æ–∫
      decreaseBtn.disabled = stats[stat.id] <= 1;
      increaseBtn.disabled = pointsLeft <= 0 || stats[stat.id] >= 5;
    });

    // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
    updateGenerateButton();
  }

  // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–Ω–æ–ø–∫–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
  function updateGenerateButton() {
    const name = document.getElementById('character-name').value.trim();
    const generateBtn = document.getElementById('generate-btn');

    // –ú–æ–∂–Ω–æ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å, –µ—Å–ª–∏ –∏–º—è –≤–≤–µ–¥–µ–Ω–æ –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤—Å–µ –æ—á–∫–∏
    if (name.length > 0 && pointsLeft === 0) {
      generateBtn.disabled = false;
    } else {
      generateBtn.disabled = true;
    }
  }

  // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞—Ä—Ç–æ—á–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
  document.getElementById('generate-btn').addEventListener('click', function () {
    generateCharacter();
  });

  // –§—É–Ω–∫—Ü–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
  function generateCharacter() {
    const name = document.getElementById('character-name').value.trim() || '–ê–Ω–æ–Ω–∏–º–Ω—ã–π –û–ø—Ç–∏–º–∏—Å—Ç';
    const characterCard = document.getElementById('character-card');

    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å–∞–º—É—é –≤—ã—Å–æ–∫—É—é —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫—É
    let highestStat = {name: '', value: 0};
    for (const statId in stats) {
      if (stats[statId] > highestStat.value) {
        const statData = statsData.find(s => s.id === statId);
        highestStat = {name: statData.name, value: stats[statId]};
      }
    }

    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –±–∞—Ñ—Ñ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
    const buff = generateBuff();

    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
    const prediction = generatePrediction();

    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–µ–≤–∏–∑
    const motto = generateMotto();

    // –ó–∞–ø–æ–ª–Ω—è–µ–º –∫–∞—Ä—Ç–æ—á–∫—É –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
    characterCard.innerHTML = `
        <div class="card-header">
            <h2 class="card-title">${name}</h2>
            <div class="card-subtitle">${motto}</div>
        </div>

        <div class="card-content">
            <div class="card-section">
                <h3><i class="fas fa-chart-bar"></i> –•–ê–†–ê–ö–¢–ï–†–ò–°–¢–ò–ö–ò</h3>
                <div class="stat-container">
                    ${generateStatsHTML()}
                </div>
            </div>

            <div class="card-section">
                <h3><i class="fas fa-star"></i> –ü–ï–†–ö–ò –ù–ê 2026</h3>
                <div class="perk-list-container">
                    <ul class="perk-list">
                        ${generatePerksHTML()}
                    </ul>
                </div>
            </div>

            <div class="card-section">
                <h3><i class="fas fa-magic"></i> –ë–ê–§–§ –ù–ê –ì–û–î</h3>
                <div class="buff-box">
                    <div class="buff-box-content">
                        <div class="buff-title">${buff.title}</div>
                        <p>${buff.description}</p>
                    </div>
                </div>
            </div>

            <div class="card-section">
                <h3><i class="fas fa-crystal-ball"></i> –ü–†–ï–î–°–ö–ê–ó–ê–ù–ò–ï –ù–ê 2026</h3>
                <div class="prediction-box">
                    <div class="prediction-box-content">
                        <div class="prediction-title">–ß—Ç–æ —Ç–µ–±—è –∂–¥—ë—Ç:</div>
                        <p>${prediction}</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="share-buttons">
            <button class="share-btn save" onclick="saveCharacter()">
                <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É
            </button>
            <button class="share-btn reset" onclick="resetCharacter()">
                <i class="fas fa-redo"></i> –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ
            </button>
        </div>
    `;

    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫—É
    characterCard.style.display = 'block';
    characterCard.scrollIntoView({behavior: 'smooth'});
  }

  // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è HTML –¥–ª—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
  function generateStatsHTML() {
    let html = '';
    statsData.forEach(stat => {
      const value = stats[stat.id];

      html += `
      <div class="stat-bar">
        <div class="stat-name">
          <span class="stat-icon">${stat.icon}</span>
          <span>${stat.name}</span>
        </div>
        <div class="stat-value">${value}/5</div>
      </div>
    `;
    });
    return html;
  }

  // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è HTML –¥–ª—è –ø–µ—Ä–∫–æ–≤
  function generatePerksHTML() {
    let html = '';
    selectedPerks.forEach(perkId => {
      const perk = perksData.find(p => p.id === perkId);
      if (perk) {
        html += `<li><i class="fas fa-check-circle"></i> <span>${perk.name}</span></li>`;
      }
    });
    return html;
  }

  // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –±–∞—Ñ—Ñ–∞
  function generateBuff() {
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –¥–æ–º–∏–Ω–∏—Ä—É—é—â—É—é —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫—É
    let dominantStat = '';
    let maxValue = 0;

    for (const statId in stats) {
      if (stats[statId] > maxValue) {
        maxValue = stats[statId];
        dominantStat = statId;
      }
    }

    const buffs = {
      strength: {
        title: '–†–µ–∂–∏–º "–Ø–∂–µ–Ω–∞—á–∞–ª—å–Ω–∏–∫" (–Ω–∞–¥ —Å–æ–±–æ–π)',
        description: '–î–µ–¥–ª–∞–π–Ω—ã –±–æ—è—Ç—Å—è –≤–∞—Å. –£—Ç—Ä–µ–Ω–Ω—è—è –∑–∞—Ä—è–¥–∫–∞ —Å–ª—É—á–∞–µ—Ç—Å—è —á–∞—â–µ, —á–µ–º —Ä–∞–∑ –≤ –∫–≤–∞—Ä—Ç–∞–ª. –í—ã –≥–æ–≤–æ—Ä–∏—Ç–µ "–Ω–µ—Ç" —Ç–æ–º—É, —á—Ç–æ –∫—Ä–∞–¥–µ—Ç –≤–∞—à–µ –≤—Ä–µ–º—è, –∏ "–¥–∞" ‚Äî —Ç–æ–º—É, —á—Ç–æ –ø—Ä–∏–Ω–æ—Å–∏—Ç —Ä–∞–¥–æ—Å—Ç—å.'
      },
      dexterity: {
        title: '–ê—É—Ä–∞ —Å–ø–æ–∫–æ–π–Ω–æ–≥–æ –ø–æ—Ñ–∏–≥–∏—Å—Ç–∞',
        description: '–í—ã –∑–∞–º–µ—á–∞–µ—Ç–µ –¥—Ä–∞–º—É, –Ω–æ –Ω–µ —É—á–∞—Å—Ç–≤—É–µ—Ç–µ. –¢–æ–∫—Å–∏—á–Ω—ã–µ —á–∞—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç –º–∏–º–æ, –∞ –Ω–µ–Ω—É–∂–Ω—ã–µ —Å–ø–æ—Ä—ã —Ä–∞—Å—Ç–≤–æ—Ä—è—é—Ç—Å—è –≤ –≤–æ–∑–¥—É—Ö–µ. –í—ã —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç–µ –∏ –º–µ–º—ã, –∏ —Ä–∞—Å—Å—É–¥–æ–∫.'
      },
      intelligence: {
        title: '–°—É–ø–µ—Ä—Å–∏–ª–∞ –Ω–∞—Ö–æ–¥—á–∏–≤–æ—Å—Ç–∏',
        description: '–ö–ª—é—á–∏ –≤—Å–µ–≥–¥–∞ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –ø–µ—Ä–≤–æ–π –∂–µ –∫–∞—Ä–º–∞–Ω–µ. –ü–∞—Ä–æ–ª–∏ –≤—Å–ø–æ–º–∏–Ω–∞—é—Ç—Å—è —Å –ø–µ—Ä–≤–æ–π –ø–æ–ø—ã—Ç–∫–∏. –í—ã –Ω–∞—Ö–æ–¥–∏—Ç–µ —Ä–µ—à–µ–Ω–∏—è —Ç–∞–º, –≥–¥–µ –¥—Ä—É–≥–∏–µ –≤–∏–¥—è—Ç —Ç—É–ø–∏–∫–∏.'
      },
      wisdom: {
        title: '–î–∞—Ä —Ü–∏—Ñ—Ä–æ–≤–æ–≥–æ –¥–µ—Ç–æ–∫—Å–∞',
        description: '–í—ã —á—É–≤—Å—Ç–≤—É–µ—Ç–µ, –∫–æ–≥–¥–∞ —Å–æ—Ü—Å–µ—Ç–∏ –≤—ã—Å–∞—Å—ã–≤–∞—é—Ç —ç–Ω–µ—Ä–≥–∏—é, –∏ –≤–æ–≤—Ä–µ–º—è —É—Ö–æ–¥–∏—Ç–µ –≤ –æ—Ñ—Ñ–ª–∞–π–Ω. –í–∞—à –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∫–æ–º–ø–∞—Å –≤—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ä–µ–∞–ª—å–Ω—É—é –∂–∏–∑–Ω—å.'
      },
      charisma: {
        title: '–ë–ª–∞–≥–æ—Å–ª–æ–≤–µ–Ω–∏–µ –∫–æ—Ñ–µ–π–Ω–æ–≥–æ –±–æ–≥–∞',
        description: '–ë–∞—Ä–∏—Å—Ç–∞ –≤—Å–µ–≥–¥–∞ –¥–µ–ª–∞–µ—Ç –≤–∞—à –∫–∞–ø—É—á–∏–Ω–æ —Å —Å–µ—Ä–¥–µ—á–∫–æ–º. –î—Ä—É–∑—å—è —Å–∞–º–∏ –ø—Ä–µ–¥–ª–∞–≥–∞—é—Ç –≤—Å—Ç—Ä–µ—Ç–∏—Ç—å—Å—è. –ü–∏—Ç—Ü–∞ –ø—Ä–∏–µ–∑–∂–∞–µ—Ç –≥–æ—Ä—è—á–µ–π, –∞ –∫—É—Ä—å–µ—Ä—ã –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Ç–µ—Ä—è—é—Ç –∑–∞–∫–∞–∑.'
      },
      constitution: {
        title: '–ù–µ–∏—Å—Å—è–∫–∞–µ–º—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ —ç–Ω–µ—Ä–≥–∏–∏',
        description: '–•–≤–∞—Ç–∞–µ—Ç —Å–∏–ª –Ω–∞ work, workout –∏ –≤–µ—á–µ—Ä–Ω–∏–π watch –±–µ–∑ —á—É–≤—Å—Ç–≤–∞ –≤—ã–∂–∞—Ç–æ–≥–æ –ª–∏–º–æ–Ω–∞. –í—ã –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç–µ—Å—å –∑–∞ –æ–¥–Ω—É –Ω–æ—á—å —Å–Ω–∞ –∏ –≥–æ—Ç–æ–≤—ã –∫ –Ω–æ–≤—ã–º –ø–æ–¥–≤–∏–≥–∞–º.'
      }
    };

    return buffs[dominantStat] || {
      title: '–°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –∂–∏–∑–Ω–∏',
      description: '–í—ã –Ω–∞—à–ª–∏ –∑–æ–ª–æ—Ç—É—é —Å–µ—Ä–µ–¥–∏–Ω—É –º–µ–∂–¥—É –≤—Å–µ–º–∏ —Å—Ñ–µ—Ä–∞–º–∏ –∂–∏–∑–Ω–∏. –ù–∏—á–µ–≥–æ –Ω–µ –∏–¥–µ–∞–ª—å–Ω–æ, –Ω–æ –≤—Å—ë –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ö–æ—Ä–æ—à–æ, —á—Ç–æ–±—ã —á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å —Å–µ–±—è —Å—á–∞—Å—Ç–ª–∏–≤—ã–º.'
    };
  }

  // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
  function generatePrediction() {
    const predictions = [
      '–í –º–∞—Ä—Ç–µ –≤—ã —Å–ª—É—á–∞–π–Ω–æ –Ω–∞–π–¥—ë—Ç–µ —Å—Ç–∞—Ä—ã–π –ø—Ä–æ–µ–∫—Ç –∏ –∑–∞–∫–æ–Ω—á–∏—Ç–µ –µ–≥–æ –∑–∞ weekend. –ë—É–¥–µ—Ç —á—É–≤—Å—Ç–≤–æ –ø–æ–±–µ–¥—ã –∏ –ø–æ–≤–æ–¥ –∑–∞–∫–∞–∑–∞—Ç—å –ø–∏—Ü—Ü—É.',
      '–í–∞—à–∞ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∏–∑–±–µ–≥–∞—Ç—å —Ç–æ–∫—Å–∏—á–Ω—ã—Ö –ª—é–¥–µ–π –ø—Ä–∏–≤–µ–¥—ë—Ç –∫ —Ç–æ–º—É, —á—Ç–æ –≤ –∞–≤–≥—É—Å—Ç–µ –≤—ã –ø–æ–ø–∞–¥—ë—Ç–µ –≤ –∫–æ–º–ø–∞–Ω–∏—é, –≥–¥–µ –≤—Å–µ —Å–º–µ—é—Ç—Å—è –Ω–∞–¥ –æ–¥–Ω–∏–º –∏ —Ç–µ–º –∂–µ –º–µ–º–æ–º.',
      '–û–¥–Ω–æ –∏–∑ –≤–∞—à–∏—Ö "–Ω–µ—Ç" –æ—Ç–∫—Ä–æ–µ—Ç –¥–≤–µ—Ä—å –∫ —á–µ–º—É-—Ç–æ –≤–∞–∂–Ω–æ–º—É. –í–æ–∑–º–æ–∂–Ω–æ, –∫ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–º—É –≤—ã—Ö–æ–¥–Ω–æ–º—É –∏–ª–∏ –Ω–æ–≤–æ–º—É —Ö–æ–±–±–∏.',
      '–í—ã –Ω–∞—É—á–∏—Ç–µ—Å—å –æ—Ç–ª–∏—á–∞—Ç—å —É—Å—Ç–∞–ª–æ—Å—Ç—å –æ—Ç –ª–µ–Ω–∏. –ò –ø—Ä–æ—â–∞—Ç—å —Å–µ–±–µ –∏ —Ç–æ, –∏ –¥—Ä—É–≥–æ–µ. –≠—Ç–æ –±—É–¥–µ—Ç –≤–∞—à –≥–ª–∞–≤–Ω—ã–π –ø—Ä–æ—Ä—ã–≤ –≥–æ–¥–∞.',
      '–ö–∞–∫-—Ç–æ —Ä–∞–∑ –≤—ã –≤—Å—Ç–∞–Ω–µ—Ç–µ —Å –ø–µ—Ä–≤–æ–π –ø–æ–ø—ã—Ç–∫–∏ –ø–æ –±—É–¥–∏–ª—å–Ω–∏–∫—É. –≠—Ç–æ —Å–ª—É—á–∏—Ç—Å—è —Å–ª—É—á–∞–π–Ω–æ, –Ω–æ –¥–∞—Å—Ç +100 –∫ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –≤ —Å–µ–±–µ.',
      '–í—ã –Ω–∞–π–¥—ë—Ç–µ —Å–ø–æ—Å–æ–± —Å–æ–≤–º–µ—â–∞—Ç—å –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ –æ—Ç–¥—ã—Ö –±–µ–∑ —á—É–≤—Å—Ç–≤–∞ –≤–∏–Ω—ã. –≠—Ç–æ –∏–∑–º–µ–Ω–∏—Ç –≤–∞—à–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫ —Ä–∞–±–æ—Ç–µ –Ω–∞–≤—Å–µ–≥–¥–∞.',
      '–í –≤–∞—à–µ–π –∂–∏–∑–Ω–∏ –ø–æ—è–≤–∏—Ç—Å—è —Ä–∏—Ç—É–∞–ª, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∑–∞—Ä—è–∂–∞—Ç—å –ª—É—á—à–µ –ª—é–±–æ–≥–æ –∫–æ—Ñ–µ. –ú–æ–∂–µ—Ç –±—ã—Ç—å, —ç—Ç–æ —É—Ç—Ä–µ–Ω–Ω—è—è –ø—Ä–æ–≥—É–ª–∫–∞ –∏–ª–∏ –≤–µ—á–µ—Ä–Ω—è—è —á–∞—à–∫–∞ —á–∞—è.',
      '–í—ã –ø–æ–π–º—ë—Ç–µ, —á—Ç–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ "–ø—Ä–æ–±–ª–µ–º—ã" —Ä–µ—à–∞—é—Ç—Å—è —Å–∞–º–∏, –µ—Å–ª–∏ –ø–µ—Ä–µ—Å—Ç–∞—Ç—å –æ –Ω–∏—Ö –¥—É–º–∞—Ç—å. –≠—Ç–æ –±—É–¥–µ—Ç —Å–∞–º–æ–µ —Ü–µ–Ω–Ω–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ –≥–æ–¥–∞.'
    ];

    // –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ, –Ω–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ª–æ–≥–∏–∫—É –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
    const randomIndex = Math.floor(Math.random() * predictions.length);
    return predictions[randomIndex];
  }

  // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–µ–≤–∏–∑–∞
  function generateMotto() {
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –¥–æ–º–∏–Ω–∏—Ä—É—é—â—É—é —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫—É
    let dominantStat = '';
    let maxValue = 0;

    for (const statId in stats) {
      if (stats[statId] > maxValue) {
        maxValue = stats[statId];
        dominantStat = statId;
      }
    }

    const mottos = {
      strength: '¬´–°–ø–ª—é —Å–∫–æ–ª—å–∫–æ —Ö–æ—á—É, –¥–µ–ª–∞—é —á—Ç–æ —Ö–æ—á—É¬ª',
      dexterity: '¬´–î—Ä–∞–º–∞ –Ω–µ –ø—Ä–æ–π–¥—ë—Ç, –∞ —è –ø—Ä–æ–π–¥—É¬ª',
      intelligence: '¬´–ù–∞—à—ë–ª –∫–ª—é—á–∏, –Ω–∞—à—ë–ª —Å–µ–±—è¬ª',
      wisdom: '¬´–í—ã–∫–ª—é—á–∏–ª —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, –≤–∫–ª—é—á–∏–ª –∂–∏–∑–Ω—å¬ª',
      charisma: '¬´–ü–∏—Ç—Ü–∞ –Ω–∞–π–¥—ë—Ç —Å–≤–æ–µ–≥–æ –≥–µ—Ä–æ—è¬ª',
      constitution: '¬´–≠–Ω–µ—Ä–≥–∏–∏ —Ö–≤–∞—Ç–∏—Ç –Ω–∞ –≤—Å—ë, –∫—Ä–æ–º–µ –Ω—ã—Ç—å—è¬ª'
    };

    return mottos[dominantStat] || '¬´–ú–µ–Ω—å—à–µ –ø–µ—Ä—Ñ–µ–∫—Ü–∏–æ–Ω–∏–∑–º–∞, –±–æ–ª—å—à–µ –ø–∏—Ç—Ü—ã¬ª';
  }

  // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏
  function saveCharacter() {
    const name = document.getElementById('character-name').value.trim() || '–ü–µ—Ä—Å–æ–Ω–∞–∂';

    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –º–æ–±–∏–ª—å–Ω–æ–µ –ª–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
    const isMobile = window.innerWidth <= 768;

    // –°–æ–∑–¥–∞–µ–º canvas
    const canvas = document.createElement('canvas');
    const ctx = canvas.getContext('2d');

    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã
    canvas.width = 1000;
    canvas.height = 1400;

    // 1. –§–æ–Ω –∫–∞—Ä—Ç–æ—á–∫–∏
    ctx.fillStyle = 'rgba(255, 255, 255, 0.95)';

    const cardX = 40;
    const cardY = 40;
    const cardWidth = canvas.width - 80;
    const cardHeight = canvas.height - 80;
    const borderRadius = 16;

    // –†–∏—Å—É–µ–º —Å–∫—Ä—É–≥–ª–µ–Ω–Ω—É—é –∫–∞—Ä—Ç–æ—á–∫—É
    drawRoundedRect(ctx, cardX, cardY, cardWidth, cardHeight, borderRadius);
    ctx.fill();

    // –í–µ—Ä—Ö–Ω—è—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–∞—è –ø–æ–ª–æ—Å–∞
    const borderGradient = ctx.createLinearGradient(cardX, cardY, cardX + cardWidth, cardY);
    borderGradient.addColorStop(0, '#8a2be2');
    borderGradient.addColorStop(0.5, '#ff6b6b');
    borderGradient.addColorStop(1, '#8a2be2');
    ctx.fillStyle = borderGradient;
    ctx.fillRect(cardX, cardY, cardWidth, 5);

    // –î–µ–∫–æ—Ä –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É
    ctx.fillStyle = 'rgba(138, 43, 226, 0.1)';
    ctx.beginPath();
    ctx.moveTo(cardX + cardWidth, cardY);
    ctx.lineTo(cardX + cardWidth, cardY + 120);
    ctx.lineTo(cardX + cardWidth - 120, cardY);
    ctx.closePath();
    ctx.fill();

    let currentY = cardY + 70;

    // 2. –ó–∞–≥–æ–ª–æ–≤–æ–∫
    ctx.fillStyle = '#2d1b69';
    ctx.font = 'bold 42px "Courier New", monospace';
    ctx.textAlign = 'center';

    let displayName = name.toUpperCase();
    const maxNameWidth = cardWidth - 100;
    let nameMetrics = ctx.measureText(displayName);

    if (nameMetrics.width > maxNameWidth) {
      while (ctx.measureText(displayName + '...').width > maxNameWidth && displayName.length > 3) {
        displayName = displayName.substring(0, displayName.length - 1);
      }
      displayName += '...';
    }

    ctx.fillText(displayName, cardX + cardWidth / 2, currentY);

    // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç (–¥–µ–≤–∏–∑)
    const motto = generateMotto();
    ctx.fillStyle = '#ff6b6b';
    ctx.font = 'bold 24px Arial';
    ctx.fillText(motto, cardX + cardWidth / 2, currentY + 40);

    // –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å
    currentY += 80;
    ctx.strokeStyle = '#e0e0e0';
    ctx.setLineDash([5, 3]);
    ctx.beginPath();
    ctx.moveTo(cardX + 60, currentY);
    ctx.lineTo(cardX + cardWidth - 60, currentY);
    ctx.stroke();
    ctx.setLineDash([]);

    // –û—Ç—Å—Ç—É–ø –ø–æ—Å–ª–µ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è
    currentY += 70;

    // 3. –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
    ctx.fillStyle = '#8a2be2';
    ctx.font = 'bold 30px Arial';
    ctx.textAlign = 'left';
    ctx.fillText('–•–ê–†–ê–ö–¢–ï–†–ò–°–¢–ò–ö–ò', cardX + 60, currentY);

    currentY += 50;

    // –í—Å–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –≤ –æ–¥–∏–Ω —Å—Ç–æ–ª–±–µ—Ü
    const columnX = cardX + 60;
    const columnWidth = cardWidth - 120;
    const statSpacing = 55; // –û–¥–∏–Ω–∞–∫–æ–≤—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏

    for (let i = 0; i < statsData.length; i++) {
      const stat = statsData[i];
      const value = stats[stat.id];
      const statY = currentY + i * statSpacing;

      // –≠–º–æ–¥–∑–∏
      ctx.fillStyle = '#333';
      ctx.font = '30px Arial';
      ctx.fillText(stat.icon, columnX, statY);

      // –ù–∞–∑–≤–∞–Ω–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
      ctx.font = 'bold 20px Arial';
      ctx.fillText(stat.name, columnX + 45, statY);

      // –ó–Ω–∞—á–µ–Ω–∏–µ (—Å–ø—Ä–∞–≤–∞)
      ctx.fillStyle = '#8a2be2';
      ctx.font = 'bold 30px "Courier New", monospace';
      const valueX = columnX + columnWidth - 80;
      ctx.fillText(`${value}/5`, valueX, statY + 5);
    }

    // –û—Ç—Å—Ç—É–ø –ø–æ—Å–ª–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
    currentY += statsData.length * statSpacing + 40;

    // 4. –ü–µ—Ä–∫–∏
    ctx.fillStyle = '#8a2be2';
    ctx.font = 'bold 30px Arial';
    ctx.fillText('–ü–ï–†–ö–ò –ù–ê 2026', cardX + 60, currentY);

    currentY += 50;

    if (selectedPerks.length > 0) {
      // –í—Å–µ –ø–µ—Ä–∫–∏ –≤ –æ–¥–∏–Ω —Å—Ç–æ–ª–±–µ—Ü
      const perkColumnX = cardX + 60;
      const perkItemHeight = 32;
      const perkSpacing = 35; // –û–¥–∏–Ω–∞–∫–æ–≤—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –ø–µ—Ä–∫–∞–º–∏

      for (let i = 0; i < selectedPerks.length; i++) {
        const perk = perksData.find(p => p.id === selectedPerks[i]);
        if (!perk) continue;

        const perkY = currentY + i * perkSpacing;

        // –ì–∞–ª–æ—á–∫–∞
        ctx.fillStyle = '#4CAF50';
        ctx.font = 'bold 18px Arial';
        ctx.fillText('‚úì', perkColumnX, perkY);

        // –ù–∞–∑–≤–∞–Ω–∏–µ –ø–µ—Ä–∫–∞
        ctx.fillStyle = '#333';
        ctx.font = '19px Arial';

        let perkName = perk.name;
        const maxPerkNameWidth = cardWidth - 140;
        let perkNameMetrics = ctx.measureText(perkName);

        if (perkNameMetrics.width > maxPerkNameWidth) {
          while (ctx.measureText(perkName + '...').width > maxPerkNameWidth && perkName.length > 3) {
            perkName = perkName.substring(0, perkName.length - 1);
          }
          perkName += '...';
        }

        ctx.fillText(perkName, perkColumnX + 30, perkY);
      }

      // –û—Ç—Å—Ç—É–ø –ø–æ—Å–ª–µ –ø–µ—Ä–∫–æ–≤
      currentY += selectedPerks.length * perkSpacing + 40;
    } else {
      ctx.fillStyle = '#999';
      ctx.font = 'italic 20px Arial';
      ctx.fillText('–ü–µ—Ä–∫–∏ –Ω–µ –≤—ã–±—Ä–∞–Ω—ã', cardX + 60, currentY);
      currentY += 60;
    }

    // 5. –ë–∞—Ñ—Ñ –Ω–∞ –≥–æ–¥
    ctx.fillStyle = '#ff6b6b';
    ctx.font = 'bold 30px Arial';
    ctx.fillText('–ë–ê–§–§ –ù–ê –ì–û–î', cardX + 60, currentY);

    currentY += 40;

    // –†–∏—Å—É–µ–º –±–ª–æ–∫ –±–∞—Ñ—Ñ–∞
    const buff = generateBuff();

    // –§–æ–Ω –±–∞—Ñ—Ñ–∞
    ctx.fillStyle = '#e6f7ff';
    const buffHeight = 110;
    drawRoundedRect(ctx, cardX + 60, currentY, cardWidth - 120, buffHeight, 12);
    ctx.fill();

    // –õ–µ–≤–∞—è –≥—Ä–∞–Ω–∏—Ü–∞
    ctx.fillStyle = '#ff6b6b';
    ctx.fillRect(cardX + 60, currentY, 5, buffHeight);

    // –ó–∞–≥–æ–ª–æ–≤–æ–∫ –±–∞—Ñ—Ñ–∞
    ctx.fillStyle = '#ff6b6b';
    ctx.font = 'bold 24px Arial';
    ctx.fillText(buff.title, cardX + 80, currentY + 35);

    // –û–ø–∏—Å–∞–Ω–∏–µ –±–∞—Ñ—Ñ–∞
    ctx.fillStyle = '#333';
    ctx.font = '18px Arial';

    const description = buff.description;
    const maxWidth = cardWidth - 160;
    let descY = currentY + 70;

    const words = description.split(' ');
    let line = '';
    for (let n = 0; n < words.length; n++) {
      const testLine = line + words[n] + ' ';
      const metrics = ctx.measureText(testLine);

      if (metrics.width > maxWidth && n > 0) {
        ctx.fillText(line, cardX + 80, descY);
        line = words[n] + ' ';
        descY += 25;
      } else {
        line = testLine;
      }
    }
    ctx.fillText(line, cardX + 80, descY);

    // –û—Ç—Å—Ç—É–ø –ø–æ—Å–ª–µ –±–∞—Ñ—Ñ–∞
    currentY += buffHeight + 70;

    // 6. –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
    ctx.fillStyle = '#ff9800';
    ctx.font = 'bold 30px Arial';
    ctx.fillText('–ü–†–ï–î–°–ö–ê–ó–ê–ù–ò–ï –ù–ê 2026', cardX + 60, currentY);

    currentY += 40;

    // –†–∏—Å—É–µ–º –±–ª–æ–∫ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
    const prediction = generatePrediction();

    // –§–æ–Ω –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
    ctx.fillStyle = '#fff8e6';
    const predictionHeight = 100;
    drawRoundedRect(ctx, cardX + 60, currentY, cardWidth - 120, predictionHeight, 12);
    ctx.fill();

    // –õ–µ–≤–∞—è –≥—Ä–∞–Ω–∏—Ü–∞
    ctx.fillStyle = '#ff9800';
    ctx.fillRect(cardX + 60, currentY, 5, predictionHeight);

    // –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
    ctx.fillStyle = '#ff9800';
    ctx.font = 'bold 22px Arial';
    ctx.fillText('–ß—Ç–æ —Ç–µ–±—è –∂–¥—ë—Ç:', cardX + 80, currentY + 32);

    // –¢–µ–∫—Å—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
    ctx.fillStyle = '#333';
    ctx.font = '17px Arial';

    const predictionText = prediction;
    const maxPredictionWidth = cardWidth - 160;
    let predY = currentY + 62;

    const predWords = predictionText.split(' ');
    let predLine = '';
    for (let n = 0; n < predWords.length; n++) {
      const testPredLine = predLine + predWords[n] + ' ';
      const predMetrics = ctx.measureText(testPredLine);

      if (predMetrics.width > maxPredictionWidth && n > 0) {
        ctx.fillText(predLine, cardX + 80, predY);
        predLine = predWords[n] + ' ';
        predY += 22;
      } else {
        predLine = testPredLine;
      }
    }
    ctx.fillText(predLine, cardX + 80, predY);

    // –û—Ç—Å—Ç—É–ø –ø–æ—Å–ª–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
    currentY += predictionHeight + 60;

    // 7. –ü–æ–¥–ø–∏—Å—å - –ø—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ–±—ã –Ω–µ –Ω–∞–µ–∑–∂–∞–ª–∞ –Ω–∞ –∫–æ–Ω—Ç–µ–Ω—Ç
    ctx.fillStyle = '#666';
    ctx.font = '16px Arial';
    ctx.textAlign = 'center';

    // –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –ø–æ–¥–ø–∏—Å—å –ø–æ–º–µ—â–∞–µ—Ç—Å—è
    const minFooterY = cardY + cardHeight - 40;
    const footerY = Math.min(currentY, minFooterY);

    // –†–∏—Å—É–µ–º –ø–æ–¥–ø–∏—Å—å —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å –º–µ—Å—Ç–æ
    if (footerY < cardY + cardHeight - 20) {
      ctx.fillText('–°–¥–µ–ª–∞–Ω–æ —Å ‚ù§Ô∏è –¥–ª—è –ê–ª–∏—Å—ã –∏ –ú–∏—à–∏', cardX + cardWidth / 2, footerY);
    }

    // 8. –°–∫–∞—á–∏–≤–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
    canvas.toBlob(function (blob) {
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `${name.replace(/\s+/g, '_')}_2026.png`;
      document.body.appendChild(a);
      a.click();

      setTimeout(() => {
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
      }, 100);
    }, 'image/png', 1.0);
  }

  // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∏—Å–æ–≤–∞–Ω–∏—è —Å–∫—Ä—É–≥–ª–µ–Ω–Ω—ã—Ö –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–æ–≤
  function drawRoundedRect(ctx, x, y, width, height, radius) {
    ctx.beginPath();
    ctx.moveTo(x + radius, y);
    ctx.lineTo(x + width - radius, y);
    ctx.quadraticCurveTo(x + width, y, x + width, y + radius);
    ctx.lineTo(x + width, y + height - radius);
    ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);
    ctx.lineTo(x + radius, y + height);
    ctx.quadraticCurveTo(x, y + height, x, y + height - radius);
    ctx.lineTo(x, y + radius);
    ctx.quadraticCurveTo(x, y, x + radius, y);
    ctx.closePath();
  }

  // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É roundRect –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
  if (!CanvasRenderingContext2D.prototype.roundRect) {
    CanvasRenderingContext2D.prototype.roundRect = function (x, y, width, height, radius) {
      if (width < 2 * radius) radius = width / 2;
      if (height < 2 * radius) radius = height / 2;

      this.beginPath();
      this.moveTo(x + radius, y);
      this.arcTo(x + width, y, x + width, y + height, radius);
      this.arcTo(x + width, y + height, x, y + height, radius);
      this.arcTo(x, y + height, x, y, radius);
      this.arcTo(x, y, x + width, y, radius);
      this.closePath();
      return this;
    };
  }

  // –°–±—Ä–æ—Å –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
  function resetCharacter() {
    if (confirm('–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞? –¢–µ–∫—É—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å –±—É–¥–µ—Ç –ø–æ—Ç–µ—Ä—è–Ω.')) {
      // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
      pointsLeft = 15;
      statsData.forEach(stat => {
        stats[stat.id] = 1;
      });

      // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–µ—Ä–∫–∏
      selectedPerks = [];

      // –°–±—Ä–∞—Å—ã–≤–∞–µ–º UI
      updateUI();

      // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–±–æ—Ä –ø–µ—Ä–∫–æ–≤
      perksData.forEach(perk => {
        const perkElement = document.getElementById(`perk-${perk.id}`);
        perkElement.classList.remove('selected');
      });

      // –°–∫—Ä—ã–≤–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫—É
      document.getElementById('character-card').style.display = 'none';

      // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –Ω–∞–≤–µ—Ä—Ö
      window.scrollTo({top: 0, behavior: 'smooth'});
    }
  }

  // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∏–º–µ–Ω–∏
  document.getElementById('character-name').addEventListener('input', updateGenerateButton);
</script>
</body>
</html>
